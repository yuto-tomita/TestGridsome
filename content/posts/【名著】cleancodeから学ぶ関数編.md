---
title: 【名著】CleanCodeから学ぶ関数編
description: CleanCodeのアウトプット③関数
date: 2020-12-22
tags: teck リファクタリング
path: /article/5
---
## 小さいこと！
関数の第一規則は、小さくせよ！第二の規則はさらに小さくせよ！です。
とても小さな関数が優れていることを示す研究への参照を提供することはできませんが、筆者は約40年コードを書き続けてきたという経験に基づく事実だといいます。

とあるプログラマの開発しているプログラムを筆者がみたときに、関数の短さに驚いたそうです。
このプログラムは３〜４行ほどの長さの関数で作成されていて、それぞれが透明で明瞭なものだと筆者は言っています。

## １つのことを行う
関数では１つのことを行うようにせよ。その１つのことをきちんと行い、それ以外のことを行ってはならない。

#### １つのことは？
関数の名前の通りの動作をしていることは、その関数が１つのことをしていると言えます。
つまり関数を書く目的は、ある１つのより広い概念を、いくつかのステップに分解することなのです。

関数が１つ以上のことをしていないか調べる方法として、その関数の実装の中から単なる言い換えではなく、別の関数を抽出できるかを調べることです。

## １つの関数に１つの抽象レベル
関数が「ひとつのこと」のみを行っているかを確実にするには、その関数内の文が１つの抽象レベルにあるかを確認する必要があります。

## コード通読
コードは上から下へと物語のように読める必要があります。
プログラムリストを上から読んだときに関数の抽象レベルが降順で読めるように、関数は抽象レベルの順番に並んでいる必要があります。

## 内容をよく表す名前を使う
ワードの原則「そこに書かれているルーチンを読んだとき、それがあなたの予想を上回るものであったとしたら、あなたはクリーンコードの中で作業をしていることに気づくのです。」
この原則の半分は、１つのことを行う小さな関数に適切な名前をつけることで達成できます。
関数を小さくし、そこに注目するようになるに従い、内容を表す名前をつけることは簡単になっていきます。

長い名前をつけるのを怖がらないでください。内容をよく表す長い名前は、不可解な短い名前よりも優れているのです。
内容を説明した長いコメントよりも優れているのです。

## 関数の引数

関数の引数は理想的には０です。その次に１つ、そして２がすぐ近くに続きます。
3つ以上はできれば避けるべきです。
引数が１つだけなら、大して難しいものではありません。２つの引痛が必要になると、この問題は少しばかり厄介なものとなります。

## 動詞とキーワード

関数の名前を選ぶという作業は、関数の意図を説明し、引数の順序と意図を説明するのに、大いに役立つでしょう。１匹数の場合、関数名と引数は洗練された動詞・名詞の組み合わせとなります。

## DRY(Don't Repeat Yourself)原則

書いたプログラムに重複しているコードを探してみてください。
重複は問題です。これはコードの量を増やし、アルゴリズムに変更が必要な場合4箇所を修正しなければならないからです。これは修正漏れの確率も4倍になるということです。

## 構造化プログラミング

全ての関数と関数ないの全てのブロックは入り口と出口を１つにすべきと提唱しました。
このルール西違うと、関数内のreturn文は１つだけになり、ループ内にはbreak, continue文は存在せず、goto文も存在しないことになります。

## なぜ関数をこのように書くのでしょう？

ソフトウェアを書くということは文章の執筆と同じようなものです。論文や記事を書くときに、まず自分を思いを書き出して、それからそれらが読みやすくなるように練り込んでいきます。
最初の草稿はぎこちなく、うまく構成されていないものです。そこで様々な推敲をおこない、構成の見直しと洗練を行います。
これを仮に、自分が読者となったとしたらそのように読みたいと思うような状態になるまで続けます。

関数を書くとき、最初は長く複雑なものとなります。深いインデントとループのネストがあります。
引数リストは長く、名前はぞんざいです。またコードには重複があります。
次にコードをねって洗練していきます。関数を分離し、名前を変更し、重複を排除していくのです。
メソッドを短縮し、並び替えます。

## 最後に
自分はよくJavaScriptを書いているのですが、最近関数ですべきことを１つのみにしようと処理を結構まとめていたりします。
意外と処理ごとに関数を切っていくのって大変でバグが起きたりして難しいんですよね。。
DRYの原則も最近とても大事な考え方だなって思い知らされる機会がありまして、自分はそうしないようにと頑張っているところです。。。。
関数は小さくて１つのことしかしないというのを念頭においてこれからも頑張っていきます。




